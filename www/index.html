<!DOCTYPE html>
<html>
    <head>
        <title>Activities for Kids</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="css/ui-lightness/jquery-ui-1.10.1.custom.min.css" />
        <link rel="stylesheet" href="css/jquery.mobile.1.2.min.css" />         
		<link rel="stylesheet" href="css/style.css" />         
                        
        <script src="js/jquery.1.8.2.min.js"></script>
		<script src="js/jquery-ui-1.10.1.custom.min.js"></script>   
        <script src="js/jquery.mobile.1.2.min.js"></script>  
        <script src="js/sounds.js"></script>
		<script type="text/javascript" charset="utf-8" src="cordova.js"></script>
		<script src="GAPlugin.js"></script>
		<script src="js/jquery.ui.touch.punch.min.js"></script>
        
        <style type="text/css">
			body, html {
				overflow-y: hidden;
				overflow-x: hidden;
			}
			
			#dropStart {
				padding: 6px;
				text-align: center;
				background-color: #CCCCCC;
			}
			
			.ui-page .ui-content {
				overflow:hidden; 
				padding: 0px!important;
			}
		</style>
        
		<script type="text/javascript" charset="utf-8">
									
			$(function() {
				// on exit
				try {
					gaPlugin.exit(nativePluginResultHandler, nativePluginErrorHandler);				
				} finally {
				}				
			});
			
			var gaPlugin;
			document.addEventListener("deviceready", myDeviceReadyListener, false);
			
			function myDeviceReadyListener() {			
				gaPlugin = window.plugins.gaPlugin;
				gaPlugin.init(gaSuccess, gaError, "UA-23823097-5", 10);
				//23823097-5 <-- web property
			} 
			
			function gaSuccess() {
				try
				{
					gaPlugin.trackPage( nativePluginResultHandler, nativePluginErrorHandler, "index.html");
					$("#gaResults").html("<span class='success'>GA tracked pageview!</span>");
					//$("#pageHome ul li a").off("click").on("click", function() {
					//	gaPlugin.trackPage( nativePluginResultHandler, nativePluginErrorHandler, $(this).attr("href") );
					//});
				} catch (e) {
					//$("#gaResults").html("<span class='error'>GA could not track pageview - " + e + "</span>");
				}
			}
			
			function gaError() {
				//$("#gaResults").append("<span class='error'>GA error</span>");
			}
			
			function nativePluginResultHandler(obj) {
				//$("#gaResults").append("<br /><span class='warn'>GA Plugin Result - ");
				if (obj != undefined) {
				//	$("#gaResults").append(obj);
				}
				//$("#gaResults").append("</span>");
			}
			
			function nativePluginErrorHandler() {
				//$("#gaResults").append("<span class='error'>GA Plugin Error Result</span>");
			}
			
			function getPhoneGapPath() {
				var path = window.location.pathname;
				path = path.substr( path, path.length - 10 );
				return 'file://' + path;
			}
			
			function trackPageUrl(pageUrl) {
				try {
					gaPlugin.trackPage( nativePluginResultHandler, nativePluginErrorHandler, pageUrl );
				} catch (e) {
					// not an app
				}
			}
			
			// Play audio
			//
			function playAudio(url) {
				// Play the audio file at url
				try {
					var my_media = new Media(url,
						// success callback
						function() {
							//alert("playAudio():Audio Success");
						},
						// error callback
						function(err) {
							alert("playAudio():Audio Error: " + err);
					});
				
					// Play audio
					my_media.play();
				} catch(e) {
					// there was a problem playing Media
				}
			}
		</script>
		
    </head>
    <body>

		<div data-role="page" id="pageHome" data-cache="never">
        	<script>
				$("#pageHome").bind('pagebeforeshow', function() {
					$(".gameTile").css({ "top": "0px", "left": "0px" }).show();
				
					var h = $(window).height();
					var offsetH = $("#pageHome .ui-header").height() + 36;
					//alert(h + " / " + offsetH);
					$("#pageHome .ui-content").css("height", h - offsetH );
				});
				
				$("#pageHome").bind("pageinit", function() {
					$( ".gameTile" ).draggable();
					$( "#dropStart" ).droppable({
					  drop: function( event, ui ) {
						$( this ).find( "p" ).html( "Lets Play!" );
						$(ui.draggable).fadeOut('slow', function() {
							var pageUrl = $(ui.draggable).data("game-page");							
							trackPageUrl(pageUrl);
							$.mobile.changePage("#" + pageUrl);
						});					
					  }
					});
				});				
			</script>
            
            <style type="text/css">
				.gameTile img {
					-moz-border-radius: 10px;
					border-radius: 10px;
					background-color: #ccc;
					border: 1px solid #ddd;
					width: 128px;
					height: 128px;
				}
			</style>
        
			<div data-role="header" data-theme="b">
				<h1>Fun Activities For Kids</h1>
			</div><!-- /header -->

			<div data-role="content" style="overflow:hidden;">	
				
                <table style="width: 100%; height: 100%; text-align: center;" cellpadding="4" cellspacing="1">
                	<tr style="height: 50%;">
                    	<td style="width: 33%;">
                        	<div id="" class="gameTile" data-game-page="pageGame1">
                                <img src="icon.png" />
                            </div>
                        </td>
                        <td id="dropStart">
                           	<p>Drop here</p>                           
                        </td>
                        <td style="width: 33%;">
                        	<div id="" class="gameTile" data-game-page="pageGame2">
                                <img src="images/match_game.png" alt="Match Games" />
                            </div>
                        </td>
                    </tr>
                    <tr style="height: 50%;">
                    	<td style="width: 33%;">
                        	<div id="" class="gameTile" data-game-page="pageGame3">
                                <img src="images/puzzle_game.png" alt="Puzzles" />
                            </div>
                        </td>
                        <td style="width: 33%;">
                        	<div id="" class="gameTile" data-game-page="pageGame4">
                                <img src="images/sounds_game.png" alt="Sound Effects" />
                            </div>
                        </td>
                        <td style="width: 33%;">
                        	<div id="" class="gameTile" data-game-page="pageGame5">
                                <img src="images/shapes_game.png" alt="Shapes" />
                            </div>
                        </td>
                    </tr>
                </table>
                                 
			</div><!-- /content -->

		</div><!-- /page -->
        
        <div data-role="page" id="pageGame1" data-cache="never" style="overflow:hidden;">
        	<script>
				var sheepCounted = 0;
				var soundPlayer = new SoundPlayer();
				
				$("#pageGame1").bind('pagebeforeshow', function() {				
					$("#scene-container, #sunset").css({ "width": $(window).width() + "px", "height": $(window).height() + "px" });
					var foregroundHeight = Math.min(($(window).height() * .5), 266);
					$("#foreground-fence").css({ "height": foregroundHeight + "px", "width": $(window).width() + "px" });
					//$("#fence").css({ "top": ($(window).height() - 270 + ( 225 - $(window).height() * .3 ) ) + "px" });
				});
				
				$("#pageGame1").bind('pageshow', function() {
								
					$( "#sheep1" ).draggable();
					$( "#flock" ).droppable({
					  drop: function( event, ui ) {
						//$( this ).addClass( "ui-state-highlight" ).find( "p" ).html( "Dropped!" );
						sheepCounted++;
						$("#sheepCount").html(sheepCounted);
						
						$("#sheep1").fadeOut('slow', function() {
							walkInNextSheep();
							placeStar();
							var $flockedSheep = $("<img src='images/count-sheep/sheep-1.png' class='flockedSheep' />");
							var bottomRandom = getRandomInt(0, 120);
							var rightRandom = getRandomInt(0, 290);
							var sizeRandom = getRandomInt(60, 100);
							$($flockedSheep).css({ "height": sizeRandom + "px", "width": sizeRandom + "px", "right": rightRandom + "px", "bottom": bottomRandom + "px", "z-index": 50 - sheepCounted});
							//$("#scene-container").append($flockedSheep);							
						});		
						if (sheepCounted == 5) {
							$( "#.popFinishedSheep" ).popup("open");
						}
					  }
					});
				
					walkInNextSheep();
				});
				
				function walkInNextSheep() {
					$("#sheep1").css({ "left": "-100px", "bottom": "50px" }).show().animate({"left":"60px", "bottom" : "50px" }, "slow");
					var soundUrl = getPhoneGapPath() + "sounds/sheep.wav";
					playAudio(soundUrl);
				}
				
				function placeStar() {
					$("#scene-container").append("<img src='images/count-sheep/star.png' class='star' style='width: " + getRandomInt(12, 27) + "; right: " + getRandomInt(0, ($(window).width() / 2)) + "px; top: " + getRandomInt(0, ( $(window).height() * .4 ) ) + "px' />");
				}
				
				function getRandomInt (min, max) {
					return Math.floor(Math.random() * (max - min + 1)) + min;
				}

				
			</script>
            
            <style type="text/css">
				#scene-container {
					position: relative; 
					width: 100%;; 
					background-color: #000;
				}
				#sheep1 {
					background:transparent url(images/count-sheep/sheep-1.png) center center no-repeat; 
					position: absolute; left: -100px; bottom: 50px; 
					width: 103px; height: 103px;
					z-index: 6;
				}
				.flockedSheep {
					position: absolute;
					z-index: 5;
				}
				#flock {
					position: absolute; 
					right: -20px; 
					bottom: -20px;
					width: 35%; 
					height: 47%;					
					z-index: 6;
					border: 1px dashed #eee;
				}
				.star {
					position: absolute;
					z-index: 5;
				}
				#moon {
					height: 140px;
					width: 140px;
					background: transparent url(images/count-sheep/moon.png) top left no-repeat;
					position: absolute;
					top: 10px;
					right: 40px;
				}
				#sheepCount {
					width: 94%;
					position: relative;
					top: 60px;
					font-weight: bold;
					text-align: center;
				}				
				#foreground-fence {
					height: 225px;
					width: 800px;
					background: transparent url(images/count-sheep/foreground-fence.png) left top no-repeat;
					position: absolute;
					left: 0px;
					bottom: 0px;						
					z-index: 4;
				}
				#sunset {
					background: transparent url(images/count-sheep/sunset.png) left top no-repeat;
					position: absolute;
					top: 0px;
					left: 0px;
					z-index: 1;
				}
			</style>
        
			<!-- <div data-role="header">
				<h1>Help the Sheep!</h1>
			</div>/header -->

			<div data-role="content">
            	<div id="scene-container">
                	<!--<img src="images/count-sheep/count-sheep.png" width="100%" height="100%" />-->
                    <div id="moon">
                    	<div id="sheepCount"></div>
                    </div>
                    <div id="foreground-fence"></div>
                    <div id="sunset"></div>
                    
                	<div id="sheep1">&nbsp;</div>
                    <div id="flock">&nbsp;</div>
                </div> 
			</div><!-- /content -->
			
			<div data-role="popup" id="popFinishedSheep">
				<a href="#" data-rel="back" data-role="button" data-theme="a" data-icon="delete" data-iconpos="notext" class="ui-btn-right">Close</a>
				You counted 5 sheep!  Good night...
			</div>
		</div><!-- /page -->
    	
        <div data-role="page" id="pageGame2">
        	<script type="text/javascript">
				$("#pageGame2").bind("pagebeforeshow", function() {
					$("#test1").css({ "width": ($(window).width() - 1) + "px", "height": ($(window).height() - 1) + "px", "border": "2px solid red" });
				});
			</script>
        	        	
        	<div data-role="content">
            	<div id="test1">Match Game!</div>                
            </div>
        
        </div> <!-- /page -->
        
        <div data-role="page" id="pageGame3">
        	<script type="text/javascript">
				$("#pageGame3").bind("pagebeforeshow", function() {
										
				});			
				
			</script>
        	        	
        	<div data-role="content">
				<p>Puzzle game go!</p>
            </div>
        
        </div> <!-- /page -->
        
        <div data-role="page" id="pageGame4">
        	<script type="text/javascript">
				$("#pageGame4").bind("pagebeforeshow", function() {
					
				});			
				
			</script>
        	        	
        	<div data-role="content">
				<p>Sound Effects</p>
            </div>
        
        </div> <!-- /page -->
        
        <div data-role="page" id="pageGame5">
        	<script type="text/javascript">
				$("#pageGame5").bind("pagebeforeshow", function() {
										
				});			
				
			</script>
        	        	
        	<div data-role="content">
				<p>Shapes and Colors</p>
            </div>
        
        </div> <!-- /page -->
        
        
    </body>
</html>